<div class="flex flex-col lg:flex-row gap-6 max-w-7xl mx-auto mt-10">
    <!-- LEFT: sale Detail -->
    <div class="w-full lg:w-2/3 bg-white shadow-md rounded-2xl border border-gray-200 p-6">
      <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6">
        <h2 class="text-2xl font-semibold text-gray-800">
          Detalle de venta #{{ sale.id }}
        </h2>
  
        <div class="flex space-x-3 mt-4 sm:mt-0">
          <button
            (click)="printSale()"
            class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-md text-sm font-medium transition"
          >
            Imprimir sale
          </button>
          <button
            (click)="closeTable()"
            class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-md text-sm font-medium transition"
          >
            Cerrar venta
          </button>
        </div>
      </div>
  
      <div class="space-y-4 text-gray-700 mb-8">
        <p>
          <span class="font-semibold">Estado:</span>
          <span
            [ngClass]="{
              'text-green-600 font-semibold': sale.status === 'abierta',
              'text-red-600 font-semibold': sale.status === 'cerrada',
              'text-yellow-600 font-semibold': sale.status === 'cancelada'
            }"
          >
            {{ sale.status | titlecase }}
          </span>
        </p>
      </div>
  
      <!-- sale product table -->
      <h3 class="text-xl font-semibold text-gray-800 mb-4">Productos en esta sale</h3>
      <div *ngIf="!loading && saleProducts.length > 0" class="overflow-x-auto">
        <table class="min-w-full border border-gray-200 rounded-lg">
          <thead class="bg-gray-100 text-gray-700 uppercase text-sm font-semibold">
            <tr>
              <th class="px-6 py-3 text-left">Producto</th>
              <th class="px-6 py-3 text-center">Cantidad</th>
              <th class="px-6 py-3 text-right">Precio</th>
            </tr>
          </thead>
          <tbody class="divide-y divide-gray-200 text-gray-800">
            <tr *ngFor="let p of saleProducts" class="hover:bg-gray-50 transition-colors">
              <td class="px-6 py-3 font-medium">{{ p.name }}</td>
              <td class="px-6 py-3 text-center">{{ p.quantity }}</td>
              <td class="px-6 py-3 text-right">{{ p.price * p.quantity  }}</td>
            </tr>
          </tbody>
          <tfoot class="bg-gray-50 font-semibold text-gray-700 border-t">
            <tr>
              <td colspan="2" class="px-6 py-3 text-right">Total:</td>
              <td class="px-6 py-3 text-right">{{ totalProductsPrice() }}</td>
            </tr>
          </tfoot>
        </table>
      </div>
  
      <div *ngIf="saleProducts.length === 0 && !loading" class="text-gray-500 text-sm">
        No hay productos registrados para esta venta.
      </div>
  
      <div class="mt-8">
        <button
          (click)="navigateToSales()"
          class="bg-gray-200 hover:bg-gray-300 text-gray-800 px-4 py-2 rounded-md transition"
        >
          ← Volver a sales
        </button>
      </div>
    </div>
  
    <!-- RIGHT: Product selection and staging -->
    <div class="w-full lg:w-1/3 flex flex-col space-y-6">
      <!-- All products -->
      <div class="bg-white shadow-md rounded-2xl border border-gray-200 p-6">
        <h3 class="text-xl font-semibold text-gray-800 mb-4">Productos disponibles</h3>
  
        <!-- Search -->
        <div class="mb-4">
          <input
            type="text"
            [(ngModel)]="searchTerm"
            (input)="searchProducts()"
            placeholder="Buscar producto..."
            class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
          />
        </div>
  
        <div *ngIf="filteredProducts.length > 0" class="overflow-x-auto">
          <table class="min-w-full border border-gray-200 rounded-lg">
            <thead class="bg-gray-100 text-gray-700 uppercase text-sm font-semibold">
              <tr>
                <th class="px-4 py-2 text-left">Producto</th>
                <th class="px-4 py-2 text-right">Precio</th>
                <th class="px-4 py-2 text-center">Acción</th>
              </tr>
            </thead>
            <tbody class="divide-y divide-gray-200 text-gray-800">
              <tr *ngFor="let p of filteredProducts" class="hover:bg-gray-50 transition-colors">
                <td class="px-4 py-2">{{ p.name }}</td>
                <td class="px-4 py-2 text-right">{{ p.price  }}</td>
                <td class="px-4 py-2 text-center">
                  <button
                    (click)="addProductToPending(p)"
                    class="bg-green-500 hover:bg-green-600 text-white text-sm px-3 py-1 rounded-md transition"
                  >
                    Agregar
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
  
        <div *ngIf="filteredProducts.length === 0" class="text-gray-500 text-sm">
          No se encontraron productos.
        </div>
      </div>

  <div
  *ngIf="pendingProducts.length > 0"
  class="bg-white shadow-md rounded-2xl border border-gray-200 p-6"
  >
  <h3 class="text-lg font-semibold text-gray-800 mb-3">
    Productos por agregar
  </h3>
  
  <div class="overflow-x-auto">
    <table class="min-w-full border border-gray-200 rounded-lg">
      <thead class="bg-gray-100 text-gray-700 uppercase text-sm font-semibold">
        <tr>
          <th class="px-4 py-2 text-left">Producto</th>
          <th class="px-4 py-2 text-center">Cantidad</th>
          <th class="px-4 py-2 text-right">Subtotal</th>
          <th class="px-4 py-2 text-center">Acción</th>
        </tr>
      </thead>
      <tbody class="divide-y divide-gray-200 text-gray-800">
        <tr *ngFor="let p of pendingProducts" class="hover:bg-gray-50 transition-colors">
          <td class="px-4 py-2">{{ p.name }}</td>
          <td class="px-4 py-2 text-center">{{ p.quantity }}</td>
          <td class="px-4 py-2 text-right">
            {{ p.price * p.quantity }}
          </td>
          <td class="px-4 py-2 text-center">
            <button
              (click)="removePendingProduct(p.name)"
              class="bg-red-500 hover:bg-red-600 text-white text-sm px-3 py-1 rounded-md transition"
            >
              -
            </button>
          </td>
        </tr>
      </tbody>
      <tfoot class="bg-gray-50 font-semibold text-gray-700 border-t">
        <tr>
          <td colspan="3" class="px-4 py-2 text-right">Total:</td>
          <td class="px-4 py-2 text-right">
            {{ this.pendingProductsTotal() }}
          </td>
        </tr>
      </tfoot>
    </table>
  </div>
  
  <button
    (click)="commitProducts()"
    class="mt-4 w-full bg-blue-500 hover:bg-blue-600 text-white py-2 rounded-md transition font-medium"
  >
    Confirmar productos
  </button>
  </div>
  
    </div>
  </div>
  